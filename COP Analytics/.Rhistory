remotes::install_github("USAID-OHA-SI/tameDP")
library(rmarkdown)
library(stringr)
library(dplyr)
library(tidyverse)
library(tidyr)
library(readr)
library(readxl)
library(glamr)
library(purrr)
library(data.table)
#library(googlesheets4)
library(splitstackshape)
#library(googledrive)
library(tameDP)
library(gophr)
library(devtools)
library(keyring)
library(here)
source("~/GitHub/EA-Utilities/COP Analytics/fast_function.R")
source("~/GitHub/EA-Utilities/COP Analytics/dp_function.R")
#Read in FAST & DATAPACK files
#identify all the Data Pack files (pull in validated datapacks apps.datim.org/datapack)
datapack<- list.files("C:/Users/vdacosta/Documents/R/COP22 TOOLS/DATAPACK", full.names = TRUE)
df_all<-map_dfr(.x = datapack,
.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
#Read in FAST & DATAPACK files
#identify all the Data Pack files (pull in validated datapacks apps.datim.org/datapack)
datapack<- list.files("C:/Users/vdacosta/Documents/R/COP22 TOOLS/DATAPACK", full.names = TRUE)
# datapack<-list.files(here("COP22 TOOLS/DATAPACK"),full.names = TRUE)
#Data frame for targets
df_all<-map_dfr(.x = datapack,
.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
df_dp<- df_all %>% datapack_im_tab()
#identify all the FAST files
#Fast<-list.files(here("COP22 TOOLS/FASTS"),full.names = TRUE)
Fast<- list.files("C:/Users/vdacosta/Documents/R/COP22 TOOLS/FASTS", full.names = TRUE)
#Data frame for Intervention Budget
df.Intervention <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_Intervention(.x))
#Data frame for Cross-Cutting Attribution Budget
df.CCA <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_CCA(.x))
#Data frame for Initiative Budget
df.Initiative <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_Initiative(.x))
#additional steps for Commodities
#Data frame for Commodities Budget (prior to merging in identifiers)
df.Commodities_pre <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_Commodities(.x))
#Data frame for Mech List
df.MechsList <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_MECHSLIST(.x))
#Merge in  Mech List to make final Commodities data frame
#Note that this includes OU but not Operating Unit
#df.Commodities<- left_join(df.Commodities_pre, df.MechsList, by = "Mechanism ID")
#Data frame for Earmarks from FAST by IM
df.Earmarks_IM <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_Earmarks_IM(.x))
#Data frame for Operating Unit and Country
df.OU_Country <- read.csv (
"~/GitHub/EA-Utilities/COP Analytics/OU_Country.csv", check.names = FALSE,
fileEncoding="UTF-8-BOM")
install.packages("remotes")
install.packages("remotes")
remotes::install_github("USAID-OHA-SI/tameDP")
library(rmarkdown)
library(stringr)
library(dplyr)
library(tidyverse)
library(tidyr)
library(readr)
library(readxl)
library(glamr)
library(purrr)
library(data.table)
#library(googlesheets4)
library(splitstackshape)
#library(googledrive)
library(tameDP)
library(gophr)
library(devtools)
library(keyring)
set_email("vdacosta@usaid.gov")
glamr::load_secrets()
set_datim("VDaCosta5")
setwd("C:/Users/vdacosta/Documents/R")
source("~/GitHub/EA-Utilities/COP Analytics/fast_function.R")
source("~/GitHub/EA-Utilities/COP Analytics/dp_function.R")
#Read in FAST & DATAPACK files
#identify all the Data Pack files (pull in validated datapacks apps.datim.org/datapack)
datapack<- list.files("C:/Users/vdacosta/Documents/R/COP22 TOOLS/DATAPACK", full.names = TRUE)
df_all<-map_dfr(.x = datapack,
.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
View(df_all)
View(datapack_im_tab)
#Read in FAST & DATAPACK files
#identify all the Data Pack files (pull in validated datapacks apps.datim.org/datapack)
datapack<- list.files("C:/Users/vdacosta/Documents/R/COP22 TOOLS/DATAPACK", full.names = TRUE)
df_all<-map_dfr(.x = datapack,
.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
View(df_all)
colSums(is.na(df_all))
df_dp<- df_all %>% datapack_im_tab()
#identify all the FAST files
#Fast<-list.files(here("COP22 TOOLS/FASTS"),full.names = TRUE)
Fast<- list.files("C:/Users/vdacosta/Documents/R/COP22 TOOLS/FASTS", full.names = TRUE)
#Data frame for Intervention Budget
df.Intervention <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_Intervention(.x))
#Data frame for Intervention Budget
df.Intervention <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_Intervention(.x))
#Data frame for Cross-Cutting Attribution Budget
df.CCA <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_CCA(.x))
#Data frame for Initiative Budget
df.Initiative <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_Initiative(.x))
#additional steps for Commodities
#Data frame for Commodities Budget (prior to merging in identifiers)
df.Commodities_pre <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_Commodities(.x))
#Data frame for Mech List
df.MechsList <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_MECHSLIST(.x))
#Data frame for Earmarks from FAST by IM
df.Earmarks_IM <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_Earmarks_IM(.x))
#Data frame for Operating Unit and Country
df.OU_Country <- read.csv (
"~/GitHub/EA-Utilities/COP Analytics/OU_Country.csv", check.names = FALSE,
fileEncoding="UTF-8-BOM")
#bind all data frames
df.COP22PlanningDataset<-bind_rows(df.Intervention,df.CCA, df.Initiative,
df.Commodities_pre, df.Earmarks_IM) %>%
COP22_master_clean()
df.COP22PlanningDataset<-left_join(df.COP22PlanningDataset, df.MechsList, by = "Mechanism ID")     %>% dplyr::rename("Country" = `Operating Unit`)
#add in Operating Unit
df.COP22PlanningDataset <- merge(df.COP22PlanningDataset, df.OU_Country, by = "Country")
#dplyr::rename("Country" = `Operating Unit`)
#RUN IF HAVE FASTS AND DATAPACK
df.COP22PlanningDataset_Final <-bind_rows(df.COP22PlanningDataset,df_dp)
write_csv(df.COP22PlanningDataset_Final,here("C:/Users/vdacosta/Documents/R/COP22 TOOLS/FAST_DATAPACK_03_30_22.csv"))
##DATAPACK OUTPUT
write_csv(df_all,here("C:/Users/vdacosta/Documents/R/COP22 TOOLS/Datapack_03_30_22.csv"))
#WITHDISAGGREGATES  #Requested 3.24
df_datapack_all<-df_all %>%
get_names() %>%
dplyr::mutate(`Agency Category` = `fundingagency`)%>%
dplyr:: mutate(`Agency Category` = ifelse(`Agency Category` == "USAID", "USAID",
ifelse(`Agency Category` == "USAID/WCF", "USAID",
ifelse(`Agency Category` == "HHS/CDC", "CDC",
ifelse(`Agency Category` == "Dedup","Dedupe", "Other"
))))) %>%
dplyr::mutate(`Agency Category`= as.character(`Agency Category`))
#WITHDISAGGREGATES  #Requested 3.24
df_datapack_all<-df_all %>%
get_names() %>%
dplyr::mutate(`Agency Category` = `fundingagency`)%>%
dplyr:: mutate(`Agency Category` = ifelse(`Agency Category` == "USAID", "USAID",
ifelse(`Agency Category` == "USAID/WCF", "USAID",
ifelse(`Agency Category` == "HHS/CDC", "CDC",
ifelse(`Agency Category` == "Dedup","Dedupe", "Other"
))))) %>%
dplyr::mutate(`Agency Category`= as.character(`Agency Category`))
write_csv(df_datapack_all,("C:/Users/vdacosta/Documents/R/COP22 TOOLS/Datapack_Agency_IM_03_30_22.csv") )
df_dp<- df_all %>% datapack_im_tab() %>%
rename("Country2"= "Country")
df_dp<- df_dp %>%
rename("Country2"= "Country")
library(rmarkdown)
library(stringr)
library(dplyr)
library(tidyverse)
library(tidyr)
library(readr)
library(readxl)
library(glamr)
library(purrr)
library(data.table)
#library(googlesheets4)
library(splitstackshape)
#library(googledrive)
library(tameDP)
library(gophr)
library(devtools)
library(keyring)
library(here)
df_dp<- df_all %>% datapack_im_tab() %>%
rename("Country2"= "Country")
df_dp<- left_join(df_dp, df.rename, by = "Mechanism ID") %>%
dplyr::mutate(countryname2 = case_when(`Mechanism ID`== "86252" | `Mechanism ID`== "100129"| `Mechanism ID`== "100139"|  `Mechanism ID`== "81114"|  `Mechanism ID`== "100110"|  `Mechanism ID`== "100105"|  `Mechanism ID`== "84311" |  `Mechanism ID`== "100130"|  `Mechanism ID`== "100140"|  `Mechanism ID`== "81144"|  `Mechanism ID`== "100106"|  `Mechanism ID`== "100111"|  mech_code== "84230" |  mech_code== "100131"|  `Mechanism ID`== "100141"|  `Mechanism ID`== "81176"|  `Mechanism ID`== "100112"|  `Mechanism ID`== "84360" |  `Mechanism ID`== "81325"|  `Mechanism ID`== "100113"| `Mechanism ID`== "100138"|   `Mechanism ID`== "100143"| `Mechanism ID`== "100114"|  `Mechanism ID`== "84730"  ~ Country, TRUE ~ countryname)) %>%
select (-c(Country2, Country)) %>%
rename("Country"= "countryname2")
#IMPORT DATASET WITH CORRECT WHR COUNTRIES TO MECHANISM MAPPING
df.rename<- read.csv("C:/Users/vdacosta/Documents/R/COP22 TOOLS/rename.csv" , check.names = FALSE) %>%
rename("Mechanism ID"= "ï»¿mech_code") %>%
dplyr::mutate(`Mechanism ID`= as.character(`Mechanism ID`))
View(df.rename)
df_dp<- left_join(df_dp, df.rename, by = "Mechanism ID") %>%
dplyr::mutate(countryname2 = case_when(`Mechanism ID`== "86252" | `Mechanism ID`== "100129"| `Mechanism ID`== "100139"|  `Mechanism ID`== "81114"|  `Mechanism ID`== "100110"|  `Mechanism ID`== "100105"|  `Mechanism ID`== "84311" |  `Mechanism ID`== "100130"|  `Mechanism ID`== "100140"|  `Mechanism ID`== "81144"|  `Mechanism ID`== "100106"|  `Mechanism ID`== "100111"|  mech_code== "84230" |  mech_code== "100131"|  `Mechanism ID`== "100141"|  `Mechanism ID`== "81176"|  `Mechanism ID`== "100112"|  `Mechanism ID`== "84360" |  `Mechanism ID`== "81325"|  `Mechanism ID`== "100113"| `Mechanism ID`== "100138"|   `Mechanism ID`== "100143"| `Mechanism ID`== "100114"|  `Mechanism ID`== "84730"  ~ Country, TRUE ~ countryname)) %>%
select (-c(Country2, Country)) %>%
rename("Country"= "countryname2")
df_dp<- df_all %>% datapack_im_tab() %>%
rename("Country2"= "Country")
df_dp<- left_join(df_dp, df.rename, by = "Mechanism ID") %>%
dplyr::mutate(countryname2 = case_when(`Mechanism ID`== "86252" | `Mechanism ID`== "100129"| `Mechanism ID`== "100139"|  `Mechanism ID`== "81114"|  `Mechanism ID`== "100110"|  `Mechanism ID`== "100105"|  `Mechanism ID`== "84311" |  `Mechanism ID`== "100130"|  `Mechanism ID`== "100140"|  `Mechanism ID`== "81144"|  `Mechanism ID`== "100106"|  `Mechanism ID`== "100111"|  `Mechanism ID`== "84230" |  `Mechanism ID`== "100131"|  `Mechanism ID`== "100141"|  `Mechanism ID`== "81176"|  `Mechanism ID`== "100112"|  `Mechanism ID`== "84360" |  `Mechanism ID`== "81325"|  `Mechanism ID`== "100113"| `Mechanism ID`== "100138"|   `Mechanism ID`== "100143"| `Mechanism ID`== "100114"|  `Mechanism ID`== "84730"  ~ Country, TRUE ~ countryname)) %>%
select (-c(Country2, Country)) %>%
rename("Country"= "countryname2")
df_dp<- left_join(df_dp, df.rename, by = "Mechanism ID") %>%
dplyr::mutate(countryname2 = case_when(`Mechanism ID`== "86252" | `Mechanism ID`== "100129"| `Mechanism ID`== "100139"|  `Mechanism ID`== "81114"|  `Mechanism ID`== "100110"|  `Mechanism ID`== "100105"|  `Mechanism ID`== "84311" |  `Mechanism ID`== "100130"|  `Mechanism ID`== "100140"|  `Mechanism ID`== "81144"|  `Mechanism ID`== "100106"|  `Mechanism ID`== "100111"|  `Mechanism ID`== "84230" |  `Mechanism ID`== "100131"|  `Mechanism ID`== "100141"|  `Mechanism ID`== "81176"|  `Mechanism ID`== "100112"|  `Mechanism ID`== "84360" |  `Mechanism ID`== "81325"|  `Mechanism ID`== "100113"| `Mechanism ID`== "100138"|   `Mechanism ID`== "100143"| `Mechanism ID`== "100114"|  `Mechanism ID`== "84730"  ~ Country, TRUE ~ Country2)) %>%
select (-c(Country2, Country)) %>%
rename("Country"= "countryname2")
unique(df_dp$Country)
View(df.rename)
View(df_dp)
#Read in FAST & DATAPACK files
#identify all the Data Pack files (pull in validated datapacks apps.datim.org/datapack)
datapack<- list.files("C:/Users/vdacosta/Documents/R/COP22 TOOLS/DATAPACK", full.names = TRUE)
#Data frame for targets
df_all<-map_dfr(.x = datapack,
.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
#Data frame for targets
df_all<-map_dfr(.x = datapack,
.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
df_all<-map_dfr(.x = datapack,
.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
#Read in FAST & DATAPACK files
#identify all the Data Pack files (pull in validated datapacks apps.datim.org/datapack)
datapack<- list.files("C:/Users/vdacosta/Documents/R/COP22 TOOLS/DATAPACK", full.names = TRUE)
#Data frame for targets
##make sure HOME tab in caribbean datapack is changed to Jamaica
##make sure HOME tab in central america datapack is changed to Brazi
df_all<-map_dfr(.x = datapack,
.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
source("~/GitHub/EA-Utilities/COP Analytics/dp_function.R")
#Read in FAST & DATAPACK files
#identify all the Data Pack files (pull in validated datapacks apps.datim.org/datapack)
datapack<- list.files("C:/Users/vdacosta/Documents/R/COP22 TOOLS/DATAPACK", full.names = TRUE)
#Data frame for targets
##make sure HOME tab in caribbean datapack is changed to Jamaica
##make sure HOME tab in central america datapack is changed to Brazi
df_all<-map_dfr(.x = datapack,.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
df_all<- map_dfr(.x = datapack,.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
df_all<-map_dfr(.x = datapack,
.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
library(rmarkdown)
library(stringr)
library(dplyr)
library(tidyverse)
library(tidyr)
library(readr)
library(readxl)
library(glamr)
library(purrr)
library(data.table)
#library(googlesheets4)
library(splitstackshape)
#library(googledrive)
library(tameDP)
library(gophr)
library(devtools)
library(keyring)
source("~/GitHub/EA-Utilities/COP Analytics/fast_function.R")
source("~/GitHub/EA-Utilities/COP Analytics/dp_function.R")
#Read in FAST & DATAPACK files
#identify all the Data Pack files (pull in validated datapacks apps.datim.org/datapack)
datapack<- list.files("C:/Users/vdacosta/Documents/R/COP22 TOOLS/DATAPACK", full.names = TRUE)
#Data frame for targets
##make sure HOME tab in caribbean datapack is changed to Jamaica
##make sure HOME tab in central america datapack is changed to Brazi
df_all<-map_dfr(.x = datapack,
.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
#identify all the FAST files
#Fast<-list.files(here("COP22 TOOLS/FASTS"),full.names = TRUE)
Fast<- list.files("C:/Users/vdacosta/Documents/R/COP22 TOOLS/FASTS", full.names = TRUE)
#Data frame for Intervention Budget
df.Intervention <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_Intervention(.x))
#Data frame for Intervention Budget
df.Intervention <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_Intervention(.x))
#Data frame for Cross-Cutting Attribution Budget
df.CCA <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_CCA(.x))
#Data frame for targets
##make sure HOME tab in caribbean datapack is changed to Jamaica
##make sure HOME tab in central america datapack is changed to Brazi
df_all<-map_dfr(.x = datapack,
.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
df_all<-map_dfr(.x = datapack,
.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
f_all<-map_dfr(.x = datapack,
.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
df_all<-map_dfr(.x = datapack,
.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
#Read in FAST & DATAPACK files
#identify all the Data Pack files (pull in validated datapacks apps.datim.org/datapack)
datapack<- list.files("C:/Users/vdacosta/Documents/R/COP22 TOOLS/DATAPACK June 10", full.names = TRUE)
df_all<-map_dfr(.x = datapack,
.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
df_all<-map_dfr(.x = datapack,
.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
#Data frame for Initiative Budget
df.Initiative <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_Initiative(.x))
#Read in FAST & DATAPACK files
#identify all the Data Pack files (pull in validated datapacks apps.datim.org/datapack)
datapack<- list.files("C:/Users/vdacosta/Documents/R/COP22 TOOLS/DATAPACK", full.names = TRUE)
df_all<-map_dfr(.x = datapack,
.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
source("~/GitHub/EA-Utilities/COP Analytics/fast_function.R")
source("~/GitHub/EA-Utilities/COP Analytics/dp_function.R")
#Read in FAST & DATAPACK files
#identify all the Data Pack files (pull in validated datapacks apps.datim.org/datapack)
datapack<- list.files("C:/Users/vdacosta/Documents/R/COP22 TOOLS/DATAPACK", full.names = TRUE)
#IMPORT DATASET WITH CORRECT WHR COUNTRIES TO MECHANISM MAPPING
df.rename<- read.csv("C:/Users/vdacosta/Documents/R/COP22 TOOLS/rename.csv" , check.names = FALSE) %>%
rename("Mechanism ID"= "ï»¿mech_code") %>%
dplyr::mutate(`Mechanism ID`= as.character(`Mechanism ID`))
df_all<-map_dfr(.x = datapack,
.f= ~ tame_dp(.x, type = "PSNUxIM", map_names=FALSE))
df_dp<- df_all %>% datapack_im_tab() %>%
rename("Country2"= "Country")
df_dp<- left_join(df_dp, df.rename, by = "Mechanism ID") %>%
dplyr::mutate(countryname2 = case_when(`Mechanism ID`== "86252" | `Mechanism ID`== "100129"| `Mechanism ID`== "100139"|  `Mechanism ID`== "81114"|  `Mechanism ID`== "100110"|  `Mechanism ID`== "100105"|  `Mechanism ID`== "84311" |  `Mechanism ID`== "100130"|  `Mechanism ID`== "100140"|  `Mechanism ID`== "81144"|  `Mechanism ID`== "100106"|  `Mechanism ID`== "100111"|  `Mechanism ID`== "84230" |  `Mechanism ID`== "100131"|  `Mechanism ID`== "100141"|  `Mechanism ID`== "81176"|  `Mechanism ID`== "100112"|  `Mechanism ID`== "84360" |  `Mechanism ID`== "81325"|  `Mechanism ID`== "100113"| `Mechanism ID`== "100138"|   `Mechanism ID`== "100143"| `Mechanism ID`== "100114"|  `Mechanism ID`== "84730"  ~ Country, TRUE ~ Country2)) %>%
select (-c(Country2, Country)) %>%
rename("Country"= "countryname2")
unique(df_dp$Country)
#identify all the FAST files
#Fast<-list.files(here("COP22 TOOLS/FASTS"),full.names = TRUE)
Fast<- list.files("C:/Users/vdacosta/Documents/R/COP22 TOOLS/FASTS", full.names = TRUE)
#Data frame for Intervention Budget
df.Intervention <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_Intervention(.x))
#Data frame for Intervention Budget
df.Intervention <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_Intervention(.x))
#Data frame for Cross-Cutting Attribution Budget
df.CCA <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_CCA(.x))
#Data frame for Initiative Budget
df.Initiative <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_Initiative(.x))
#Data frame for Initiative Budget
df.Initiative <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_Initiative(.x))
#additional steps for Commodities
#Data frame for Commodities Budget (prior to merging in identifiers)
df.Commodities_pre <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_Commodities(.x))
#Data frame for Mech List
df.MechsList <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_MECHSLIST(.x))
#Data frame for Earmarks from FAST by IM
df.Earmarks_IM <- purrr::map_dfr(.x = Fast,
.f = ~ FAST_Earmarks_IM(.x))
df.OU_Country <- read.csv (
"~/GitHub/EA-Utilities/COP Analytics/OU_Country.csv", check.names = FALSE,
fileEncoding="UTF-8-BOM")
#bind all data frames
df.COP22PlanningDataset<-bind_rows(df.Intervention,df.CCA, df.Initiative,
df.Commodities_pre, df.Earmarks_IM) %>%
COP22_master_clean()
df.COP22PlanningDataset<-left_join(df.COP22PlanningDataset, df.MechsList, by = "Mechanism ID")     %>% dplyr::rename("Country" = `Operating Unit`)
#add in Operating Unit
df.COP22PlanningDataset <- merge(df.COP22PlanningDataset, df.OU_Country, by = "Country")
#dplyr::rename("Country" = `Operating Unit`)
#RUN IF HAVE FASTS AND DATAPACK
df.COP22PlanningDataset_Final <-bind_rows(df.COP22PlanningDataset,df_dp)
write_csv(df.COP22PlanningDataset_Final,here("C:/Users/vdacosta/Documents/R/COP22 TOOLS/FAST_DATAPACK_06_13_22.csv"))
#WITHDISAGGREGATES
df_datapack_all<-df_all %>%
get_names() %>%
dplyr::mutate(`Agency Category` = `fundingagency`)%>%
dplyr:: mutate(`Agency Category` = ifelse(`Agency Category` == "USAID", "USAID",
ifelse(`Agency Category` == "USAID/WCF", "USAID",
ifelse(`Agency Category` == "HHS/CDC", "CDC",
ifelse(`Agency Category` == "Dedup","Dedupe", "Other"
))))) %>%
dplyr::mutate(`Agency Category`= as.character(`Agency Category`))
###Incorporate central america renaming
df.rename2<- read.csv("C:/Users/vdacosta/Documents/R/COP22 TOOLS/rename.csv" , check.names = FALSE) %>%
rename("mech_code"= "ï»¿mech_code") %>%
dplyr::mutate(`mech_code`= as.character(`mech_code`))
df_datapack_all_join <- left_join(df_datapack_all, df.rename2, by = "mech_code")
df_datapack_all_clean<- df_datapack_all_join %>%
dplyr::mutate(countryname2 = case_when(mech_code== "86252" | mech_code== "100129"|  mech_code== "100139"|  mech_code== "81114"|  mech_code== "100110"|  mech_code== "100105"|  mech_code== "84311" |  mech_code== "100130"|  mech_code== "100140"|  mech_code== "81144"|  mech_code== "100106"|  mech_code== "100111"|  mech_code== "84230" |  mech_code== "100131"|  mech_code== "100141"|  mech_code== "81176"|  mech_code== "100112"|  mech_code== "84360" |  mech_code== "81325"|  mech_code== "100113"| mech_code== "100138"|   mech_code== "100143"| mech_code== "100114"|  mech_code== "84730"  ~ Country, TRUE ~ countryname)) %>%
select (-c(countryname, Country)) %>%
rename("countryname"= "countryname2")
write_csv(df_datapack_all_clean,("C:/Users/vdacosta/Documents/R/COP22 TOOLS/Datapack_Agency_IM_06_11_22.csv") )
library(rmarkdown)
library(rmarkdown)
devtools::install_github("USAID-OHA-SI/glamr")
1
library(glamr)
devtools::install_github("USAID-OHA-SI/glamr")
options(gargle_oauth_email = 'vdacosta@usaid.gov')
'C:/Users/vdacosta/Documents/.Rprofile'
glamr::set_paths()
set_paths(folderpath_msd = "~/Documents/R/DQ/msd")
glamr::si_path(type = "path_msd")
devtools::install_github("USAID-OHA-SI/glamr")
source("~/GitHub/EA-Utilities/COP Analytics/dp_function.R")
library(tameDP)
remotes::install_github("USAID-OHA-SI/tameDP")
remotes::install_github("USAID-OHA-SI/tameDP")
install.packages("tameDP")
install.packages("glamr")
remotes::install_github("USAID-OHA-SI/gophr")
install.packages("devtools")
remotes::install_github("USAID-OHA-SI/tameDP")
devtools::install_github("USAID-OHA-SI/glamr")
updateR()
devtools::install_github("USAID-OHA-SI/glamr")
install.packages("purrr")
install.packages("devtools")
install.packages("remotes")
install.packages("remotes")
install.packages("devtools")
install.packages("devtools")
load("C:/Users/vdacosta/Documents/R/.RData")
install.packages("devtools")
install.packages("devtools")
devtools::install_github("USAID-OHA-SI/glamr")
remotes::install_github("USAID-OHA-SI/tameDP")
remotes::install_github("USAID-OHA-SI/tameDP")
#install.packages("googledrive")
devtools::install_github("USAID-OHA-SI/glamr")
devtools::install_github("USAID-OHA-SI/glamr")
